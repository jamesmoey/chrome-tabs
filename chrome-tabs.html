<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../iron-menu-behavior/iron-menubar-behavior.html">
<link rel="import" href="./chrome-tab.html">


<!--
`chrome-tabs`
Chrome tabs

@demo demo/index.html
-->

<dom-module id="chrome-tabs">
  <template>
    <style>
      :host {
        display: flex;
        box-sizing: border-box;
        position: relative;
        font-size: 10px;
        height: 4.2em;
        background: linear-gradient(#dad9da, #d9d8d9);
        padding: 1em 1.2em 0.45em 1.2em;
        border-radius: 0.5em 0.5em 0 0;
        box-shadow: 0 0.05em #b7b7b7;
        overflow: hidden;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      }
      * {
        box-sizing: inherit;
        font-family: inherit;
      }
      .chrome-tabs-bottom-bar {
        position: absolute;
        bottom: 0;
        height: 0.45em;
        left: 0;
        width: 100%;
        background: #f2f2f2;
        box-shadow: 0 -0.05em rgba(0,0,0,0.27);
        z-index: 20;
      }
      .chrome-tabs-content {
        position: relative;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }
      /*
      .chrome-tabs-background {
        display: flex;
        padding: 0px 5px;
      }
      */
      /*
      .chrome-tab {
        position: absolute;
        left: 0;
        height: 2.8em;
        width: 24em;
        border: 0;
        margin: 0;
        z-index: 1;
      }
      */
    </style>
    <slot></slot>
  </template>

  <script>
    Polymer({

      is: 'chrome-tabs',

      properties: {
        selectable: {
          type: String,
          value: 'chrome-tab'
        },
        _previousTab: {
          type: Object
        },
      },

      hostAttributes: {
        role: 'tablist',
      },

      behaviors: [
        Polymer.IronMenubarBehavior,
      ],

      listeners: {
        'iron-select': '_onIronSelect',
        'iron-deselect': '_onIronDeselect',
      },

      _onIronSelect: function(event) {
        this._tabChanged(event.detail.item, this._previousTab);
        this._previousTab = event.detail.item;
        this.cancelDebouncer('tab-changed');
      },

      _onIronDeselect: function(event) {
        this.debounce('tab-changed', function() {
          this._tabChanged(null, this._previousTab);
          this._previousTab = null;
        // See polymer/polymer#1305
        }, 1);
      },

      _tabChanged: function(tab, old) {
        // console.log(tab);
      },

      _activateHandler: function() {
        // Cancel item activations scheduled by keyboard events when any other
        // action causes an item to be activated (e.g. clicks).
        // this._cancelPendingActivation();
        Polymer.IronMenuBehaviorImpl._activateHandler.apply(this, arguments);
      },

    });
  </script>
</dom-module>
